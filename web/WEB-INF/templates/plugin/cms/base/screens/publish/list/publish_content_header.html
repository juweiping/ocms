<HTML>
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta HTTP-EQUIV="Pragma"  CONTENT="no-cache"/>
<meta HTTP-EQUIV="Cache-Control" CONTENT="no-cache"/>
<title>cms content header</title>
<base  href="${baseUrl}"/>
<link rel='stylesheet' type='text/css' href='html/plugin/cms/base/css/style.css' />
<script type="text/javaScript" src="html/common/js/prototype.js"></script>
<BODY   style="PADDING-RIGHT: 0px; PADDING-LEFT: 0px; PADDING-BOTTOM: 0px; MARGIN: 0px; PADDING-TOP: 0px">

<script language='JavaScript'>
function refreshWorkArea()
{
 document.location =  document.location
}
var doImage = doImage;
var TType = TType;
var popupWin=null;
function mhHover(tbl, idx, cls)
{
	var t, d;
	if (document.getElementById)
		t = document.getElementById(tbl);
	else
		t = document.all(tbl);
	if (t == null) return;
	if (t.getElementsByTagName)
		d = t.getElementsByTagName("TD");
	else
		d = t.all.tags("TD");
	if (d == null) return;
	if (d.length <= idx) return;
	d[idx].className = cls;
}



</script>
<SCRIPT>
var elo;
var loadmenuok=false;
var type = 'main';
var cId = '';
function initrightmenu(){
	loadmenuok = true;
}



function going(action, pId) {
	switch(action) {
		case 'viewpublish':
			eval('var mPath = mPath_' + pId + '.href');
			window.open(mPath,"","")

			break;
		default:
			
	}
	//
}


</SCRIPT>

<SCRIPT language=JavaScript>
<!--
function gogo(url)
{
	top.panelWork.location = url;
}

function CheckAll(form)  {
  for (var i=0;i<form.elements.length;i++)    {
    var e = form.elements[i];
    if (e.name != 'chkall' && e.name !='copy')       e.checked = form.chkall.checked;
   }
  }

//-->
var NodeID = '${node.nodeId?c}'
function doing(action,param)
{
	switch(action) {
		case 'createContent':
			createContent();
			break;
		case 'syncContent':
			parent.mainFrame.location = "#" +NodeID

			break;
		case 'resource_admin':
			parent.mainFrame.location = "${baseUrl}admin/resource.jhtml?action=ListResource&nodeId=" +NodeID;
			break;
		case 'extrapublish_admin':
			parent.mainFrame.location = "${baseUrl}admin/extrapublish.jhtml?action=List&nodeId=" +NodeID
			break;
		case 'contribution':
			parent.mainFrame.location = "#" +NodeID
			break;
 		case 'setting':
			//var url = urlencode(parent.mainFrame.location);
			parent.mainFrame.location = "${baseUrl}admin/nodeEdit.jhtml?mode=edit&nodeId="+NodeID;
			break;
		case 'view_index':
			{
			window.open("${baseUrl}admin/publish.jhtml?action=ViewIndex&nodeId=" +NodeID,'');
			break;
			}
		case 'edit_index':
			{
			var leftPos = (screen.availWidth-800) / 2
			var topPos = (screen.availHeight-600) / 2
			window.open('${baseUrl}admin/template.jhtml?action=EditorFrameset&mode=edit&path='+encodeURIComponent("${indexTplPath}")+'&targetFile=' + encodeURIComponent("${indexTplName}") + '&nodeId=' + NodeID + '&indexId=0', '','width=800,height=600,scrollbars=yes,resizable=yes,status=yes,titlebar=0,top=' + topPos + ',left=' + leftPos);
			break;
			}
		case 'edit_content_tpl':
			{
			var IndexID = prompt('输入IndexID（可选）', '');
			var leftPos = (screen.availWidth-800) / 2
			var topPos = (screen.availHeight-600) / 2
			var popupWin = window.open('${baseUrl}admin/template.jhtml?action=EditorFrameset&mode=edit&path='+encodeURIComponent("${contentTplPath}")+'&targetFile='+encodeURIComponent("${contentTplName}")+'&nodeId='+NodeID+'&indexId=' + IndexID, '','width=800,height=600,scrollbars=no,resizable=yes,titlebar=0,top=' + topPos + ',left=' + leftPos);			
			break;
			}
		case 'edit_image_tpl':
			{
			var leftPos = (screen.availWidth-800) / 2
			var topPos = (screen.availHeight-600) / 2
			var popupWin = window.open('${baseUrl}admin/template.jhtml?action=EditorFrameset&mode=edit&path='+encodeURIComponent("${imageTplPath}")+'&targetFile=' + encodeURIComponent("${imageTplName}") + '&nodeId=' + NodeID + '&indexId=0', '','width=800,height=600,scrollbars=no,resizable=yes,titlebar=0,top=' + topPos + ',left=' + leftPos);
			break;
			}
		case 'refresh_index':
			{
			var url='${baseUrl}admin/publish.jhtml?action=RefreshNodeIndex&nodeId=' + NodeID;
			new Ajax.Request(url,{
					method: 'post',
					onSuccess: function(transport) {
						var returnValue=transport.responseText;
						if(returnValue!=null&&returnValue!="-1"){
							alert('恭喜，成功开始刷新首页任务！');
						}else{
							alert('对不起，无法成功开始刷新首页任务！');
						}
					}
			});			
			break;
			}
		case 'refresh_view':
			parent.mainFrame.location = parent.mainFrame.location;
			break;
		case 'deploy':
			break;
		case 'recycle_bin':
			parent.mainFrame.location = "${baseUrl}admin/publish.jhtml?action=RecycleContentList&nodeId=" +NodeID
			break;
		default:
			parent.mainFrame.location = "${baseUrl}admin/publish.jhtml?action=ContentList&nodeId=" +NodeID
			break;


	}
}
function addThread(url,TaskID) {
	top.CrawlerTaskFrame.addThread(url , TaskID)

}
function createContent()
{
	var leftPos = (screen.availWidth-800) / 2
	var topPos = (screen.availHeight-600) / 2
	var popupWin = window.open('${baseUrl}admin/publishEdit.jhtml?type=main&action=ContentEditorFrameset&mode=add&nodeId='+NodeID ,'editor','width=800,height=600,scrollbars=no,resizable=yes,statusbar=1,titlebar=0,top=' + topPos + ',left=' + leftPos);
}

function refreshWorkArea()
{
 parent.mainFrame.location =  parent.mainFrame.location
}
</script>
<script>
var mousemovecolor="#D4D4D4";
var selectcolor ="#DDDDDD";
var oldcolor;

function GetRow(oElem)
{
	while (oElem)
	{	//alert(oElem.tagName.toLowerCase())
		if (oElem.tagName.toLowerCase() == "tr" || oElem.parentElement.tagName.toLowerCase() == "tbody")
		    return oElem;
		if (oElem.tagName.toLowerCase() == "table" || oElem.tagName.toLowerCase() == "th") return false;
		oElem = oElem.parentElement;
	}
}


function selected()
{	//alert(pid)

	var trstyle = GetRow( window.event.srcElement );
	var a;
	if( !trstyle )
		return false;

	if( trstyle.style.backgroundColor.toLowerCase() == selectcolor.toLowerCase())
	{
		trstyle.style.backgroundColor = "";
		a=eval("p_"+ trstyle.id);
		//alert(trstyle.id)
		if (a!=null || a.checked)
			a.checked=false
		oldcolor = "";
	}
	else
	{
		trstyle.style.backgroundColor = selectcolor;
		a=eval("p_"+ trstyle.id);
		//alert(trstyle.id)
		if (a!=null)
			a.checked=true
		oldcolor = selectcolor;


	}
}
</script>
<script language="javascript">
lastDiv = null;
function highLight(theDiv) {
	if (lastDiv) {
		lastDiv.style.border = 'solid 1px #F1F1F1';
		lastDiv.style.background = '#F1F1F1';
	}
	//alert(theDiv);
	lastDiv = theDiv;
	theDiv.style.border = ' solid 1px #999';
	theDiv.style.background = '#CCC';


}

</script>
<div id="menudata"></div>
<div id="msviLocalToolbar">
  <table cellpadding="0" cellspacing="2" width="100%" height="19" border="0">
    <tr>
      <td class="lt0" height="18" nowrap="nowrap"   >
	  <font id=large>
	  	  ${node.name}	  	  </font>
	  <font id=description>[<B>${node.nodeId?c}</B>]</font></td>
      <td></td>
      <td class="lt0" nowrap="nowrap" onMouseOver="mhHover('msviLocalToolbar', 2, 'lt1')" onMouseOut="mhHover('msviLocalToolbar', 2, 'lt0')" onClick="doing('createContent');highLight(this);">添加内容</td>



       <td><span class="ltsep">|</span></td>
      <td class="lt0" nowrap="nowrap" onMouseOver="mhHover('msviLocalToolbar', 4, 'lt1')" onMouseOut="mhHover('msviLocalToolbar', 4, 'lt0')" onClick="doing('contribution');highLight(this);">来稿</td>
     <td><span class="ltsep">|</span></td>

      <td class="lt0" nowrap="nowrap" onMouseOver="mhHover('msviLocalToolbar', 6, 'lt1')" onMouseOut="mhHover('msviLocalToolbar', 6, 'lt0')" onClick="doing('');highLight(this);">发布管理</td>

     <td><span class="ltsep">|</span></td>
      <td class="lt0" nowrap="nowrap" onMouseOver="mhHover('msviLocalToolbar', 8, 'lt1')" onMouseOut="mhHover('msviLocalToolbar', 8, 'lt0')" onClick="doing('extrapublish_admin');highLight(this);">附加发布</td>

     <td><span class="ltsep">|</span></td>
      <td class="lt0" nowrap="nowrap" onMouseOver="mhHover('msviLocalToolbar', 10, 'lt1')" onMouseOut="mhHover('msviLocalToolbar', 10, 'lt0')" onClick="doing('resource_admin');highLight(this);">资源</td>


     <td><span class="ltsep">|</span></td>
    <td class="lt0" nowrap="nowrap" onMouseOver="mhHover('msviLocalToolbar', 12, 'lt1')" onMouseOut="mhHover('msviLocalToolbar', 12, 'lt0')" onClick="doing('setting');highLight(this);">设置</td>




	   <td><span class="ltsep">|</span></td>
      <td class="lt0" nowrap="nowrap" onMouseOver="mhHover('msviLocalToolbar', 14, 'lt1')" onMouseOut="mhHover('msviLocalToolbar', 14, 'lt0')" onClick="doing('recycle_bin');highLight(this);">回收站</td>





     <td ><span class="ltsep">|</span></td>
      <td class="lt0" nowrap="nowrap"><A HREF="javascript:doing('view_index');"  >查看</A>&nbsp;/&nbsp;<A HREF="javascript:doing('edit_index');"  >编辑</A>&nbsp;/&nbsp;<A HREF="javascript:doing('refresh_index');"   >刷新首页</A></td>





     <td ><span class="ltsep">|</span></td>
      <td class="lt0" nowrap="nowrap">编辑<A HREF="javascript:doing('edit_content_tpl');"  >内容页</A>&nbsp;/&nbsp;<A HREF="javascript:doing('edit_image_tpl');"  >图片页</A>模板</td>



     <td>&nbsp;</td>
      <td width="100%"></td>
    </tr>
  </table>
</div>

</body>
</html>
